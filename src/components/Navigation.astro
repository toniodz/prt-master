---
const servicesLinks = [
  {
    title: "Struggling with Pain?",
    href: "/services/struggling-with-pain"
  },
  {
    title: "Pain Reprocessing Therapy",
    href: "/services/pain-reprocessing-therapy"
  },
  {
    title: "Already Tried it But Still in Pain?",
    href: "/services/self-help"
  },
  {
    title: "Physiotherapy Included",
    href: "/services/pain-come-on-recently"
  },
  {
    title: "For Medical Professionals",
    href: "/services/medical-professionals"
  }
];
---

<nav class="flex items-center justify-between h-20 px-4">
  <a href="/" class="text-xl font-bold">Reprocess Your Pain</a>
  
  <!-- Mobile menu button -->
  <button
    id="menuButton"
    class="lg:hidden p-2 text-gray-700 hover:text-primary transition-colors"
    aria-label="Toggle menu"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
    </svg>
  </button>

  <!-- Mobile menu -->
  <div id="mobileMenu" class="fixed inset-0 bg-white z-50 transform translate-x-full transition-transform duration-300 lg:hidden">
    <div class="h-20 px-4 flex items-center justify-between border-b">
      <a href="/" class="text-xl font-bold">Reprocess Your Pain</a>
      <button
        id="closeButton"
        class="p-2 text-gray-700 hover:text-primary transition-colors"
        aria-label="Close menu"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>
    <div class="px-4 py-6">
      <div class="space-y-4">
        <div>
          <button 
            class="flex items-center justify-between w-full text-left text-gray-700 hover:text-primary transition-colors" 
            id="mobileServicesButton"
            aria-expanded="false"
            aria-controls="mobileServicesMenu"
          >
            How Can I Help
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transform transition-transform duration-200">
              <path d="m6 9 6 6 6-6"/>
            </svg>
          </button>
          <div class="hidden pl-4 mt-2 space-y-2" id="mobileServicesMenu" role="menu">
            {servicesLinks.map(link => (
              <a
                href={link.href}
                class="block py-2 text-gray-700 hover:text-primary transition-colors"
                role="menuitem"
              >
                {link.title}
              </a>
            ))}
          </div>
        </div>
        <a href="/about" class="block text-gray-700 hover:text-primary transition-colors">About Me</a>
        <a href="/fees" class="block text-gray-700 hover:text-primary transition-colors">My Fees</a>
        <a href="/blog" class="block text-gray-700 hover:text-primary transition-colors">Articles</a>
        <a href="/contact" class="block text-gray-700 hover:text-primary transition-colors flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="20" height="16" x="2" y="4" rx="2"/>
            <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
          </svg>
          Contact Me
        </a>
        <a href="/booking" class="block w-full bg-primary text-white px-6 py-2.5 rounded text-center hover:bg-primary-hover transition-colors">
          Book an Appointment
        </a>
      </div>
    </div>
  </div>
  
  <!-- Desktop menu -->
  <div class="hidden lg:flex items-center gap-8">
    <div class="relative group">
      <button 
        class="flex items-center gap-1 text-gray-700 hover:text-primary transition-colors"
        aria-expanded="false"
        aria-controls="desktopServicesMenu"
      >
        How Can I Help
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m6 9 6 6 6-6"/>
        </svg>
      </button>
      <div 
        id="desktopServicesMenu"
        class="absolute left-0 top-full mt-2 w-72 bg-white rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50"
        role="menu"
      >
        <div class="py-2">
          {servicesLinks.map(link => (
            <a
              href={link.href}
              class="block px-4 py-2.5 text-gray-700 hover:bg-primary hover:text-white transition-colors"
              role="menuitem"
            >
              {link.title}
            </a>
          ))}
        </div>
      </div>
    </div>
    <a href="/about" class="text-gray-700 hover:text-primary transition-colors">About Me</a>
    <a href="/fees" class="text-gray-700 hover:text-primary transition-colors">My Fees</a>
    <a href="/blog" class="text-gray-700 hover:text-primary transition-colors">Articles & Resources</a>
    <a href="/contact" class="text-gray-700 hover:text-primary transition-colors flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect width="20" height="16" x="2" y="4" rx="2"/>
        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
      </svg>
      Contact Me
    </a>
  </div>
  
  <a href="/booking" class="hidden lg:block bg-primary text-white px-6 py-2.5 rounded hover:bg-primary-hover transition-colors">
    Book an Appointment
  </a>
</nav>

<script>
  const menuButton = document.getElementById('menuButton');
  const closeButton = document.getElementById('closeButton');
  const mobileMenu = document.getElementById('mobileMenu');
  const mobileServicesButton = document.getElementById('mobileServicesButton');
  const mobileServicesMenu = document.getElementById('mobileServicesMenu');

  menuButton?.addEventListener('click', () => {
    mobileMenu?.classList.remove('translate-x-full');
    document.body.style.overflow = 'hidden';
  });

  closeButton?.addEventListener('click', () => {
    mobileMenu?.classList.add('translate-x-full');
    document.body.style.overflow = '';
  });

  mobileServicesButton?.addEventListener('click', (e) => {
    e.preventDefault();
    const isExpanded = mobileServicesButton.getAttribute('aria-expanded') === 'true';
    mobileServicesButton.setAttribute('aria-expanded', !isExpanded);
    mobileServicesMenu?.classList.toggle('hidden');
    
    // Rotate arrow
    const arrow = mobileServicesButton.querySelector('svg');
    if (arrow) {
      arrow.style.transform = isExpanded ? '' : 'rotate(180deg)';
    }
  });

  // Close mobile menu when clicking outside
  document.addEventListener('click', (e) => {
    if (mobileMenu && !mobileMenu.contains(e.target as Node) && !menuButton?.contains(e.target as Node)) {
      mobileMenu.classList.add('translate-x-full');
      document.body.style.overflow = '';
    }
  });
</script>